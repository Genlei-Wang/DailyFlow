# DailyFlow 用户指南

## 目录

1. [快速开始](#快速开始)
2. [详细功能说明](#详细功能说明)
3. [最佳实践](#最佳实践)
4. [故障排除](#故障排除)

---

## 快速开始

### 第一次使用

1. **下载程序**
   - 从 GitHub Releases 下载 `DailyFlow.exe`
   - 放到任意文件夹（建议：`C:\Program Files\DailyFlow\`）

2. **首次运行**
   - 双击 `DailyFlow.exe`
   - 程序会在同级目录创建配置文件
   - 托盘区域会出现 DailyFlow 图标

3. **录制第一个任务**
   - 点击 **"🔴 录制 (F8)"** 按钮
   - 执行你要自动化的操作
   - 再次点击录制按钮停止
   - 系统提示"录制已保存"

4. **测试回放**
   - 点击 **"🟢 回放 (F12)"** 按钮
   - 观察程序自动执行你的操作

---

## 详细功能说明

### 1. 录制功能

#### 触发方式
- 点击主窗口 **"🔴 录制"** 按钮
- 按下全局热键 **F8**

#### 录制内容
- ✅ 鼠标移动（限频采样，避免数据过多）
- ✅ 鼠标点击（左键、右键、中键）
- ✅ 键盘按键（包括快捷键、功能键）
- ❌ 鼠标滚轮（暂不支持）

#### 录制技巧

**技巧 1：适当停顿**
在关键操作之间增加停顿时间，让系统有时间响应：
```
操作 1 → 等待 1-2 秒 → 操作 2
```

**技巧 2：避免多余操作**
录制时保持专注，避免无关的鼠标移动和点击。

**技巧 3：使用键盘快捷键**
尽量使用键盘快捷键而非鼠标点击菜单，可提高准确性。

#### 注意事项

⚠️ **密码安全**
- 录制会记录所有按键（包括密码）
- 密码以明文存储在 `task.json`
- 建议跳过密码输入步骤，手动输入

⚠️ **分辨率一致性**
- 录制和回放需在相同分辨率下进行
- 不同分辨率会导致坐标错位

### 2. 回放功能

#### 触发方式
- 点击主窗口 **"🟢 回放"** 按钮
- 按下全局热键 **F12**
- 定时任务自动触发

#### 速度调整

使用速度滑动条调整回放速度：

| 速度 | 适用场景 |
|------|----------|
| **1.0x** | 快速系统、本地软件 |
| **0.8x** | 一般网络应用、云软件 |
| **0.5x** | 内网老旧系统、响应慢的软件 |

**示例：**
```
原录制间隔：100ms
设置 0.5x 速度 → 实际等待：200ms
```

#### 冲突检测

回放期间，如果检测到用户移动鼠标超过 50 像素：
- 程序会自动暂停
- 防止与用户操作冲突

**如何恢复：**
1. 将鼠标移回原位
2. 重新开始回放

### 3. 定时任务

#### 配置步骤

1. **设置执行时间**
   ```
   格式：HH:MM（24 小时制）
   示例：08:30 表示每天早上 8:30
   ```

2. **启用定时任务**
   - 勾选 **"每日启用"** 复选框

3. **开机自启（可选）**
   - 勾选 **"开机自启"**
   - 电脑启动后，程序自动运行并待命

#### 执行逻辑

```
每 60 秒检查一次
  ↓
当前时间 >= 设定时间？
  ↓
今天已执行过？
  ↓ 否
执行任务 → 标记今日已完成
```

#### 状态显示

| 状态 | 说明 |
|------|------|
| **任务未配置** | 未录制任何操作 |
| **下次运行: 今天 08:30** | 今天还未执行 |
| **下次运行: 明天 08:30** | 今天已执行或时间已过 |
| **今日任务已完成** | 今天已自动执行过 |

### 4. 托盘功能

#### 最小化到托盘
- 点击窗口 **"关闭"** 按钮
- 程序隐藏到托盘（不退出）

#### 托盘菜单
右键点击托盘图标：
- **显示主界面**：打开主窗口
- **关于**：查看版本信息
- **退出程序**：完全退出 DailyFlow

#### 托盘图标提示
鼠标悬停在托盘图标上，显示：
```
DailyFlow - 自动化助手
```

---

## 最佳实践

### 场景 1：每日晨报生成

**需求：** 每天早上 8:30 自动打开系统、导出数据

**操作流程：**
1. 录制以下步骤：
   - 打开业务系统（Win+R → 输入程序名）
   - 等待系统加载（停顿 5 秒）
   - 点击"昨日"按钮
   - 点击"查询"按钮
   - 等待数据加载（停顿 3 秒）
   - 点击"导出"按钮
   - 选择保存路径
   - 关闭系统

2. 配置定时任务：
   - 执行时间：08:30
   - 勾选"每日启用"
   - 勾选"开机自启"

3. 速度设置：
   - 如果系统较慢，设置 0.6x - 0.7x

### 场景 2：批量表单填写

**需求：** 填写固定格式的表单

**操作流程：**
1. 打开表单
2. 录制一次完整填写流程
3. 测试回放，确保准确
4. 如需重复填写，多次点击回放

**技巧：**
- 使用 Tab 键切换字段（比鼠标点击更准确）
- 对于需要变化的数据，可录制多个版本

### 场景 3：系统巡检

**需求：** 每天检查系统状态、截图保存

**操作流程：**
1. 录制巡检流程：
   - 打开系统监控页面
   - 等待数据刷新
   - 截图（Win+Shift+S）
   - 保存到指定文件夹
   - 关闭页面

2. 设置早晚各执行一次：
   - 早：08:00
   - 晚：20:00
   - （需创建两个配置）

---

## 故障排除

### 问题 1：录制后回放位置不对

**可能原因：**
- 屏幕分辨率改变
- DPI 缩放设置不同

**解决方案：**
1. 检查录制和回放时的分辨率是否一致
2. 检查 Windows 显示设置 → 缩放与布局
3. 重新录制任务

### 问题 2：回放速度太快，操作失败

**可能原因：**
- 系统响应慢，操作未完成就执行下一步

**解决方案：**
1. 调慢速度：0.5x - 0.7x
2. 重新录制时，在关键步骤多停顿几秒

### 问题 3：定时任务未执行

**检查清单：**
- [ ] "每日启用"复选框是否勾选
- [ ] 执行时间是否正确（24 小时制）
- [ ] 电脑是否处于开机状态
- [ ] 电脑是否锁屏或休眠（会阻止执行）

**查看日志：**
检查 `config.json` 中的 `last_run_date` 字段。

### 问题 4：开机自启不生效

**解决方案：**
1. 手动检查快捷方式：
   ```
   %APPDATA%\Microsoft\Windows\Start Menu\Programs\Startup\
   ```
2. 如无 `DailyFlow.lnk`，重新勾选"开机自启"
3. 部分企业电脑禁止自启动，需联系 IT 管理员

### 问题 5：程序无法启动

**可能原因：**
- 已有实例运行
- 配置文件损坏

**解决方案：**
1. 打开任务管理器，结束 `DailyFlow.exe` 进程
2. 删除 `config.json` 和 `task.json`（会丢失数据）
3. 重新启动程序

### 问题 6：热键不起作用

**可能原因：**
- 其他软件占用了 F8 或 F12 热键

**解决方案：**
1. 关闭其他可能占用热键的软件
2. 使用主窗口按钮代替热键

---

## 高级技巧

### 技巧 1：备份任务数据

定期备份以下文件：
```
task.json     # 录制的操作数据
config.json   # 配置信息
```

可复制到云盘或其他机器使用。

### 技巧 2：多任务切换

如需执行不同任务：
1. 备份当前 `task.json` 为 `task_报表.json`
2. 录制新任务
3. 需要时，重命名文件切换任务

### 技巧 3：调试模式

如果回放总是失败：
1. 设置速度为 0.5x
2. 逐步执行，观察哪个步骤出错
3. 重新录制有问题的部分

### 技巧 4：配合其他工具

DailyFlow 可与以下工具配合使用：
- **Windows 任务计划程序**：更复杂的定时策略
- **AutoHotkey**：更高级的脚本控制
- **PowerShell**：批量处理文件

---

## 安全提示

### 数据安全

⚠️ **重要：**
- `task.json` 包含所有按键记录（包括密码）
- 文件为明文存储，任何人都可以查看
- 建议：
  - 不要在公共场合打开 `task.json`
  - 不要上传到公共网盘
  - 录制时跳过敏感信息输入

### 使用规范

✅ **推荐用途：**
- 自动化重复性操作
- 提高工作效率
- 个人学习和测试

❌ **禁止用途：**
- 游戏外挂、作弊
- 未经授权的系统访问
- 其他违反法律法规的行为

---

## 获取帮助

如有问题，请通过以下方式获取帮助：

1. **查看文档**
   - README.md
   - TESTING.md
   - FAQ（即将推出）

2. **提交问题**
   - GitHub Issues
   - 附上详细的问题描述和截图

3. **社区讨论**
   - GitHub Discussions
   - 与其他用户交流经验

---

**祝您使用愉快！** 🎉

