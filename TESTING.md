# DailyFlow 测试验证指南

## 测试环境要求
- Windows 7 SP1 / Windows 10 / Windows 11
- 无需安装 .NET Framework 或其他依赖
- 无需管理员权限

## 基本功能测试清单

### 1. 安装和启动测试

- [ ] 下载 `DailyFlow.exe` 到任意目录
- [ ] 双击运行，程序能正常启动
- [ ] 主窗口显示正常（320x480 尺寸）
- [ ] 托盘图标出现在系统托盘
- [ ] 关闭窗口后，程序最小化到托盘（而非退出）

### 2. 录制功能测试

#### 测试用例：录制记事本操作

1. 点击主窗口的 **"🔴 录制 (F8)"** 按钮
2. 按钮文本变为 **"⏹️ 停止录制 (F8)"**
3. 执行以下操作：
   - 按 `Win+R` 打开运行对话框
   - 输入 `notepad` 并按回车
   - 等待记事本打开（约 2 秒）
   - 输入文字 `Hello DailyFlow`
   - 点击记事本的关闭按钮
   - 在弹出的保存对话框中点击 **"不保存"**
4. 再次点击录制按钮（或按 F8）停止录制
5. 应弹出提示 **"录制已保存"**

#### 验证点：
- [ ] 录制期间，所有鼠标和键盘操作都被捕获
- [ ] 录制停止后，在程序目录下生成 `task.json` 文件
- [ ] 打开 `task.json`，验证文件内容包含 `meta` 和 `events` 字段
- [ ] `events` 数组不为空，包含鼠标移动、点击、按键事件

### 3. 回放功能测试

#### 测试用例：回放录制的操作

1. 确保桌面处于干净状态（关闭所有窗口）
2. 点击主窗口的 **"🟢 回放 (F12)"** 按钮
3. 回放应自动执行之前录制的操作
4. 观察回放过程：
   - 鼠标自动移动到录制时的位置
   - 自动点击、输入文字
   - 最终结果与录制时一致

#### 验证点：
- [ ] 回放期间，鼠标和键盘自动操作
- [ ] 操作流程与录制时完全一致
- [ ] 回放完成后，程序恢复正常状态

### 4. 变速回放测试

1. 调整主窗口中的 **"速度"** 滑动条到 `0.5x`（慢速）
2. 点击 **"🟢 回放 (F12)"** 按钮
3. 观察回放速度明显变慢
4. 验证最终结果仍然正确

#### 验证点：
- [ ] 速度标签显示正确的速度值（如 `0.5x`）
- [ ] 回放速度确实变慢，肉眼可见
- [ ] 即使变速，操作结果仍然准确

### 5. 冲突检测测试

1. 开始回放
2. 在回放过程中，手动移动鼠标超过 50 像素
3. 程序应暂停回放（或弹出警告）

#### 验证点：
- [ ] 检测到用户干预时，回放暂停或停止
- [ ] 避免与用户操作冲突

### 6. 热键功能测试

1. 关闭主窗口（最小化到托盘）
2. 按下键盘 **F8** 键
3. 应开始录制
4. 再次按 **F8** 停止录制
5. 按下键盘 **F12** 键
6. 应开始回放

#### 验证点：
- [ ] 全局热键在程序最小化时也能工作
- [ ] F8 控制录制开关
- [ ] F12 控制回放开关

### 7. 定时任务测试

1. 在主窗口配置区域：
   - 执行时间设置为当前时间后 2 分钟（如当前 14:30，则设置为 14:32）
   - 勾选 **"每日启用"** 复选框
2. 最小化程序到托盘
3. 等待到达设定时间
4. 程序应自动执行回放

#### 验证点：
- [ ] 到达设定时间后，任务自动执行
- [ ] 执行后，状态显示 **"今日任务已完成"**
- [ ] 配置文件 `config.json` 中的 `last_run_date` 更新为今天

### 8. 开机自启动测试

1. 勾选 **"开机自启"** 复选框
2. 重启计算机
3. 系统启动后，检查托盘区域
4. DailyFlow 应自动启动并出现在托盘

#### 验证点：
- [ ] 重启后程序自动启动
- [ ] 托盘图标存在
- [ ] 配置和任务数据保持不变

### 9. 配置持久化测试

1. 修改配置：
   - 执行时间：08:30
   - 速度：0.8x
   - 勾选每日启用和开机自启
2. 关闭程序（托盘右键 -> 退出程序）
3. 重新启动程序
4. 检查配置是否保持

#### 验证点：
- [ ] 配置文件正确保存
- [ ] 重启后配置恢复
- [ ] `config.json` 文件内容正确

### 10. 兼容性测试

#### Windows 7 测试
- [ ] 在纯净版 Windows 7 SP1 上运行
- [ ] 无需安装 .NET Framework 或其他依赖
- [ ] 所有功能正常工作

#### 高分屏测试
- [ ] 在高 DPI 显示器上运行（如 4K 显示器）
- [ ] 录制坐标准确
- [ ] 回放坐标准确（鼠标点击位置正确）

### 11. 稳定性测试

1. 连续回放 10 次相同任务
2. 观察程序是否崩溃或卡死
3. 检查任务管理器中的内存和句柄使用情况

#### 验收标准：
- [ ] 连续回放 10 次无崩溃
- [ ] 内存使用稳定，无明显泄漏
- [ ] 句柄数量稳定，无泄漏

### 12. 文件大小验证

检查 `DailyFlow.exe` 文件大小：

```bash
# 应小于 5MB
ls -lh DailyFlow.exe
```

#### 验收标准：
- [ ] 文件大小 < 5MB

## 问题报告模板

如果测试中发现问题，请按以下格式报告：

```
### 问题描述
[简要描述问题]

### 复现步骤
1. [步骤1]
2. [步骤2]
...

### 预期结果
[应该发生什么]

### 实际结果
[实际发生了什么]

### 环境信息
- 操作系统：Windows [版本]
- 屏幕分辨率：[分辨率]
- DPI 设置：[缩放比例]
```

## 性能基准

- 录制 1000 个事件：< 10MB JSON 文件
- 回放 1000 个事件：< 2 分钟
- 内存占用：< 50MB
- 启动时间：< 2 秒

